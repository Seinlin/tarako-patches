From 859294b0018c3271ed9d307d6b634006d5fba006 Mon Sep 17 00:00:00 2001
From: Kai-Zhen Li <kli@mozilla.com>
Date: Mon, 16 Dec 2013 13:21:10 +0800
Subject: [PATCH] enable zram for hamachi

---
 full_hamachi.mk |    3 +++
 zram.sh         |    8 ++++++++
 2 files changed, 11 insertions(+)
 create mode 100755 zram.sh

diff --git a/full_hamachi.mk b/full_hamachi.mk
index 11cf641..13c9cb8 100644
--- a/full_hamachi.mk
+++ b/full_hamachi.mk
@@ -4,6 +4,7 @@ PRODUCT_COPY_FILES := \
   device/qcom/hamachi/touch.idc:system/usr/idc/ft5x06_ts.idc \
   device/qcom/hamachi/media_profiles.xml:system/etc/media_profiles.xml \
   device/qcom/hamachi/audio.conf:system/etc/bluetooth/audio.conf \
+  device/qcom/hamachi/zram.sh:system/xbin/zram.sh \
   device/qcom/msm7627a/wpa_supplicant.conf:system/etc/wifi/wpa_supplicant.conf
 
 $(call inherit-product-if-exists, vendor/qcom/hamachi/hamachi-vendor-blobs.mk)
@@ -19,6 +20,8 @@ PRODUCT_PROPERTY_OVERRIDES += \
   ro.moz.omx.hw.max_width=640 \
   ro.moz.omx.hw.max_height=480 \
   ro.moz.ril.extra_int_2nd_call=true \
+  zram.support=true \
+  zram_for_android.enable=false \
 
 
 # Discard inherited values and use our own instead.
diff --git a/zram.sh b/zram.sh
new file mode 100755
index 0000000..92f9964
--- /dev/null
+++ b/zram.sh
@@ -0,0 +1,8 @@
+#!/system/bin/sh
+a=`getprop zram.disksize 64`
+b=`getprop sys.vm.swappiness 100`
+echo $(($a*1024*1024)) > /sys/block/zram0/disksize
+mkswap /dev/block/zram0
+swapon /dev/block/zram0
+echo $(($b)) > /proc/sys/vm/swappiness
+
-- 
1.7.9.5


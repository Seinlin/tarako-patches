From a984d44c6b6723d6a3f08009df07cd39dcf2ac29 Mon Sep 17 00:00:00 2001
From: evelynhung <jj.evelyn@gmail.com>
Date: Mon, 16 Dec 2013 02:04:41 -0800
Subject: [PATCH] Bug 959054 - Do not launch the usage widget frame when the
 phone boot up.

---
 Android.mk                     |    4 ++--
 Makefile                       |    2 +-
 apps/system/js/cost_control.js |    2 --
 3 files changed, 3 insertions(+), 5 deletions(-)

diff --git a/Android.mk b/Android.mk
index 81f29d9..e0cd1b8 100644
--- a/Android.mk
+++ b/Android.mk
@@ -25,7 +25,7 @@ CLEAN_PROFILE := 0
 # In user (production) builds we put gaia apps in /system/b2g/webapps
 ifneq ($(filter user userdebug, $(TARGET_BUILD_VARIANT)),)
 GAIA_MAKE_FLAGS += PRODUCTION=1
-B2G_SYSTEM_APPS := 1
+#B2G_SYSTEM_APPS := 1
 endif
 
 # Gaia currently needs to specify the default scale value manually or pictures
@@ -35,7 +35,7 @@ GAIA_MAKE_FLAGS += GAIA_DEV_PIXELS_PER_PX=$(GAIA_DEV_PIXELS_PER_PX)
 endif
 
 ifeq ($(B2G_SYSTEM_APPS),1)
-GAIA_MAKE_FLAGS += B2G_SYSTEM_APPS=1
+#GAIA_MAKE_FLAGS += B2G_SYSTEM_APPS=1
 GAIA_APP_INSTALL_PARENT := $(TARGET_OUT)/b2g
 CLEAN_PROFILE := 1
 endif
diff --git a/Makefile b/Makefile
index 0dd21ac..cbf11cf 100644
--- a/Makefile
+++ b/Makefile
@@ -140,7 +140,7 @@ NPM_REGISTRY?=http://registry.npmjs.org
 export npm_config_loglevel=warn
 MARIONETTE_RUNNER_HOST?=marionette-b2gdesktop-host
 
-GAIA_INSTALL_PARENT?=/system/b2g
+GAIA_INSTALL_PARENT?=/data/local
 
 ifeq ($(MAKECMDGOALS), demo)
 GAIA_DOMAIN=thisdomaindoesnotexist.org
diff --git a/apps/system/js/cost_control.js b/apps/system/js/cost_control.js
index 9f817be..fd4f8a7 100644
--- a/apps/system/js/cost_control.js
+++ b/apps/system/js/cost_control.js
@@ -113,11 +113,9 @@
       if (enabled !== false) {
         window.addEventListener('ftudone', function ftudone(e) {
           window.removeEventListener('ftudone', ftudone);
-          _ensureWidget();
           widgetFrame.setVisible(false);
         });
       } else {
-        _ensureWidget();
         widgetFrame.setVisible(false);
       }
     });
-- 
1.7.9.5


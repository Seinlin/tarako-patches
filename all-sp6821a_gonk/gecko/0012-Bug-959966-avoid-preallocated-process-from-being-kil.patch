From 7562c4e2a21cabf1cc2c9deee3d06d98db3871fb Mon Sep 17 00:00:00 2001
From: dannyliang <dliang@mozilla.com>
Date: Thu, 13 Feb 2014 19:31:01 +0800
Subject: [PATCH] Bug 959966 - avoid preallocated process from being killed
 for low memory devices.

---
 dom/ipc/ContentParent.cpp |    7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)

diff --git a/dom/ipc/ContentParent.cpp b/dom/ipc/ContentParent.cpp
index 1bfa38a..df660a3 100644
--- a/dom/ipc/ContentParent.cpp
+++ b/dom/ipc/ContentParent.cpp
@@ -1363,12 +1363,7 @@ ContentParent::ContentParent(ContentParent* aTemplate,
     // Set the subprocess's priority (bg if we're a preallocated process, fg
     // otherwise).  We do this first because we're likely /lowering/ its CPU and
     // memory priority, which it has inherited from this process.
-    ProcessPriority priority;
-    if (IsPreallocated()) {
-        priority = PROCESS_PRIORITY_BACKGROUND;
-    } else {
-        priority = PROCESS_PRIORITY_FOREGROUND;
-    }
+    ProcessPriority priority = PROCESS_PRIORITY_MASTER;
 
     InitInternal(priority,
                  false /* aIsTemplate */);
-- 
1.7.9.5

